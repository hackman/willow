<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">

<title> Willow network tools </title>

<style>
body { background: #fff; font-family: Tahoma, Verdana, Arial; font-size: 12px; padding: 0; margin: 0; color: #000; text-align: center; }
a { color: #05a8de; }
h2 { text-align: center; }
#tools { width:80%; text-align: left;  }
#results { text-align: left; }
</style>

<script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
var url = "api.pl?";

function do_cmd(cmd,host) {
	// verify host and IP
	$.ajax({
        'async': false,
        'global': false,
        'url': url + 'cmd=' + cmd + '&host=' + host,
        'dataType': 'html',
        'success': function (data) {
			$('#results').html('<hr /><pre>' + data + '</pre>');
        }
	});
}

function handle_net(event,key) {
	if (key && event.which != 13)
		return;
    event.preventDefault();
	host = $('#host').val();
	cmd  = $('#tool').val();
	if ($('#host').val !== '') {
		$('#results').html('<hr /><img src="img/progress.gif" alt="Progress">');
		do_cmd(cmd,host);
	}
}

function init_focus() {
	$('#host').focusout(function() { if ($('#host').val() === '') $('#host').val('IP or Host') });
	$('#host').focus(function() { $('#host').val('') });
}

$(document).ready(function(){
	init_focus();
	$('#host').on('keypress', function(e) { handle_net(e,1) });
	$('#exec').on('click', function(e) { handle_net(e,0) });
});

	
</script>
</head>
<body>
<h2> Willow network tools </h2>
<hr />
<div id=tools>
	<select id=tool>
		<option value=0>ping</option>
		<option value=1>traceroute</option>
		<option value=2>host</option>
		<option value=3>dig</option>
		<option value=4>whois</option>
	</select>
	<input type=text value='IP or Host' id=host> <br />
	<input type=submit value='Execute' id=exec>
</div>
<div id=results>
<hr />
</div>
</body>
</html>
